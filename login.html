<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login - 241 Runners Awareness</title>
  <link rel="stylesheet" href="assets/styles/shared.css">
  <link rel="stylesheet" href="styles.css">
  <script src="js/auth.js" defer></script>
</head>
<body>
  <!-- Include Header -->
  <div id="header-placeholder"></div>

  <main class="main-content">
    <div class="auth-container">
      <div class="auth-card">
        <div class="auth-header">
          <h1 class="auth-title">Sign In</h1>
          <p class="auth-subtitle">Welcome back to 241 Runners Awareness</p>
        </div>

        <!-- Error/Success Messages -->
        <div id="errorContainer"></div>
        <div id="successContainer"></div>

        <form id="loginForm" class="auth-form">
          <div class="form-group">
            <label for="email" class="form-label">Email Address</label>
            <input 
              type="email" 
              id="email" 
              name="email" 
              class="form-input" 
              required 
              placeholder="Enter your email"
              autocomplete="email"
            >
          </div>

          <div class="form-group">
            <label for="password" class="form-label">Password</label>
            <input 
              type="password" 
              id="password" 
              name="password" 
              class="form-input" 
              required 
              placeholder="Enter your password"
              autocomplete="current-password"
            >
          </div>

          <div class="form-group">
            <button type="submit" class="btn btn-primary w-full" id="loginButton">
              Sign In
            </button>
          </div>
        </form>

        <div class="auth-divider">
          <span>or</span>
        </div>

        <!-- Demo Credentials -->
        <div class="demo-section">
          <h4 class="demo-title">Demo Credentials</h4>
          <div class="demo-info">
            <div class="demo-credential">
              <strong>Admin:</strong> admin@example.com / ChangeMe123!
            </div>
            <div class="demo-description">
              Full access to all features including user management
            </div>
          </div>
          <button type="button" class="btn btn-secondary" onclick="fillDemoCredentials()">
            Use Demo Admin
          </button>
        </div>

        <div class="auth-footer">
          <p class="auth-link-text">
            Don't have an account? 
            <a href="signup.html" class="auth-link">Sign up here</a>
          </p>
          <p class="auth-link-text">
            <a href="forgot-password.html" class="auth-link">Forgot your password?</a>
          </p>
        </div>
      </div>
    </div>
  </main>

  <!-- Include Footer -->
  <div id="footer-placeholder"></div>

  <style>
  /* Auth-specific styles */
  .main-content {
    min-height: calc(100vh - 64px - 200px); /* Adjust for header/footer */
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-lg);
    background-color: var(--color-bg-secondary);
  }

  .auth-container {
    width: 100%;
    max-width: 400px;
  }

  .auth-card {
    background-color: var(--color-bg-primary);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-lg);
    padding: var(--spacing-2xl);
  }

  .auth-header {
    text-align: center;
    margin-bottom: var(--spacing-xl);
  }

  .auth-title {
    font-size: var(--font-size-2xl);
    font-weight: var(--font-weight-bold);
    color: var(--color-text-primary);
    margin: 0 0 var(--spacing-sm) 0;
  }

  .auth-subtitle {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
    margin: 0;
  }

  .auth-form {
    margin-bottom: var(--spacing-lg);
  }

  .auth-divider {
    position: relative;
    text-align: center;
    margin: var(--spacing-lg) 0;
  }

  .auth-divider::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 0;
    right: 0;
    height: 1px;
    background-color: var(--color-border-primary);
  }

  .auth-divider span {
    background-color: var(--color-bg-primary);
    padding: 0 var(--spacing-md);
    color: var(--color-text-secondary);
    font-size: var(--font-size-sm);
  }

  .demo-section {
    background-color: var(--color-bg-secondary);
    border-radius: var(--radius-md);
    padding: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
    text-align: center;
  }

  .demo-title {
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    color: var(--color-text-primary);
    margin: 0 0 var(--spacing-md) 0;
  }

  .demo-info {
    margin-bottom: var(--spacing-md);
  }

  .demo-credential {
    font-size: var(--font-size-sm);
    color: var(--color-text-primary);
    margin-bottom: var(--spacing-xs);
  }

  .demo-description {
    font-size: var(--font-size-xs);
    color: var(--color-text-secondary);
  }

  .auth-footer {
    text-align: center;
  }

  .auth-link-text {
    font-size: var(--font-size-sm);
    color: var(--color-text-secondary);
    margin: var(--spacing-xs) 0;
  }

  .auth-link {
    color: var(--color-primary);
    text-decoration: none;
    font-weight: var(--font-weight-medium);
  }

  .auth-link:hover {
    text-decoration: underline;
  }

  /* Alert styles */
  .alert {
    padding: var(--spacing-md);
    border-radius: var(--radius-md);
    margin-bottom: var(--spacing-lg);
    font-size: var(--font-size-sm);
  }

  .alert-error {
    background-color: rgb(239 68 68 / 0.1);
    border: 1px solid rgb(239 68 68 / 0.2);
    color: var(--color-error);
  }

  .alert-success {
    background-color: rgb(16 185 129 / 0.1);
    border: 1px solid rgb(16 185 129 / 0.2);
    color: var(--color-success);
  }

  /* Loading spinner */
  .loading-spinner {
    display: inline-block;
    width: 16px;
    height: 16px;
    border: 2px solid transparent;
    border-top: 2px solid currentColor;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-right: var(--spacing-xs);
  }

  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
  </style>

  <script>
  // Load header and footer
  document.addEventListener('DOMContentLoaded', function() {
    // Load header
    fetch('partials/header.html')
      .then(response => response.text())
      .then(html => {
        document.getElementById('header-placeholder').innerHTML = html;
      })
      .catch(error => console.error('Error loading header:', error));

    // Load footer
    fetch('partials/footer.html')
      .then(response => response.text())
      .then(html => {
        document.getElementById('footer-placeholder').innerHTML = html;
      })
      .catch(error => console.error('Error loading footer:', error));

    // Check if user is already authenticated
    if (window.Auth && window.Auth.redirectIfAuthenticated()) {
      return;
    }
  });

  // Handle form submission
  document.addEventListener('DOMContentLoaded', function() {
    const loginForm = document.getElementById('loginForm');
    const loginButton = document.getElementById('loginButton');

    if (loginForm) {
      loginForm.addEventListener('submit', async function(e) {
        e.preventDefault();

        // Clear previous messages
        window.Auth.clearMessages('errorContainer');
        window.Auth.clearMessages('successContainer');

        // Get form data
        const formData = new FormData(loginForm);
        const email = formData.get('email');
        const password = formData.get('password');

        // Validate form
        const errors = window.Auth.validateForm({ email, password });
        if (Object.keys(errors).length > 0) {
          const errorMessage = Object.values(errors)[0];
          window.Auth.showError(errorMessage);
          return;
        }

        try {
          // Show loading state
          window.Auth.showLoading(loginButton, 'Signing in...');

          // Attempt login
          await window.Auth.login(email, password);

          // Show success message
          window.Auth.showSuccess('Login successful! Redirecting...', 'successContainer');

          // Redirect to dashboard
          window.Auth.redirectWithDelay('/dashboard.html', 1000);

        } catch (error) {
          // Hide loading state
          window.Auth.hideLoading(loginButton);

          // Show error message
          window.Auth.showError(error.message || 'Login failed. Please try again.');
        }
      });
    }
  });

  // Fill demo credentials
  function fillDemoCredentials() {
    document.getElementById('email').value = 'admin@example.com';
    document.getElementById('password').value = 'ChangeMe123!';
  }
  </script>
</body>
</html> 