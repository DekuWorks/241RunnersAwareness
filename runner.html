<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Runner Profile - 241 Runners Awareness</title>
  <link rel="stylesheet" href="https://241runnersawareness.org/styles.css">
  <link rel="stylesheet" href="https://241runnersawareness.org/forms.css">
  <script src="https://241runnersawareness.org/js/auth.js" defer></script>
  <style>
    /* Main container styling */
    .runner-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
      min-height: 100vh;
    }

    /* Header styling */
    .runner-header {
      background: linear-gradient(135deg, #dc2626 0%, #b91c1c 100%);
      color: white;
      padding: 2rem;
      border-radius: 16px;
      margin-bottom: 2rem;
      box-shadow: 0 8px 32px rgba(220, 38, 38, 0.3);
      text-align: center;
    }

    .runner-avatar {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      background: white;
      margin: 0 auto 1.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 3rem;
      color: #dc2626;
      border: 4px solid rgba(255, 255, 255, 0.3);
    }

    .runner-name {
      font-size: 2.5rem;
      margin: 0 0 0.5rem 0;
      font-weight: 600;
    }

    .runner-id {
      font-size: 1.2rem;
      opacity: 0.9;
      margin: 0 0 1rem 0;
    }

    .runner-status {
      display: inline-block;
      padding: 0.5rem 1.5rem;
      border-radius: 25px;
      font-weight: 600;
      font-size: 1rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .runner-status.missing {
      background: #fef3c7;
      color: #92400e;
      border: 2px solid #f59e0b;
    }

    .runner-status.active {
      background: #d1fae5;
      color: #065f46;
      border: 2px solid #10b981;
    }

    .runner-status.found {
      background: #dbeafe;
      color: #1e40af;
      border: 2px solid #3b82f6;
    }

    /* Action buttons */
    .runner-actions {
      display: flex;
      gap: 1rem;
      justify-content: center;
      margin-top: 2rem;
      flex-wrap: wrap;
    }

    .action-btn {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s;
      border: none;
      cursor: pointer;
      font-size: 1rem;
    }

    .action-btn-primary {
      background: white;
      color: #dc2626;
    }

    .action-btn-primary:hover {
      background: #f3f4f6;
      transform: translateY(-2px);
    }

    .action-btn-secondary {
      background: rgba(255, 255, 255, 0.2);
      color: white;
      border: 2px solid rgba(255, 255, 255, 0.3);
    }

    .action-btn-secondary:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: translateY(-2px);
    }

    /* Profile sections */
    .profile-sections {
      display: grid;
      gap: 2rem;
    }

    .profile-section {
      background: white;
      border-radius: 16px;
      padding: 2rem;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      border: 1px solid #e5e7eb;
    }

    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 2px solid #f3f4f6;
    }

    .section-title {
      font-size: 1.5rem;
      color: #1f2937;
      margin: 0;
    }

    .section-badge {
      background: #dc2626;
      color: white;
      padding: 0.25rem 0.75rem;
      border-radius: 12px;
      font-size: 0.8rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* Information grid */
    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
    }

    .info-item {
      display: flex;
      flex-direction: column;
    }

    .info-label {
      font-weight: 600;
      color: #6b7280;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .info-value {
      color: #1f2937;
      font-size: 1rem;
      padding: 0.75rem;
      background: #f9fafb;
      border-radius: 8px;
      border: 1px solid #e5e7eb;
      min-height: 2.5rem;
      display: flex;
      align-items: center;
    }

    /* Restricted content styling */
    .restricted-message {
      text-align: center;
      padding: 3rem 2rem;
      background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
      border: 2px solid #f59e0b;
      border-radius: 12px;
      margin: 2rem 0;
    }

    .restricted-message h3 {
      color: #92400e;
      margin: 0 0 1rem 0;
      font-size: 1.3rem;
    }

    .restricted-message p {
      color: #92400e;
      margin: 0 0 1.5rem 0;
      font-size: 1.1rem;
    }

    .restricted-message .btn {
      display: inline-block;
      padding: 0.75rem 1.5rem;
      background: #dc2626;
      color: white;
      text-decoration: none;
      border-radius: 8px;
      font-weight: 600;
      transition: background-color 0.2s;
      border: none;
      cursor: pointer;
    }

    .restricted-message .btn:hover {
      background: #b91c1c;
    }

    /* Loading and error states */
    .loading-state, .error-state {
      text-align: center;
      padding: 4rem 2rem;
      background: white;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      border: 1px solid #e5e7eb;
    }

    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 6px solid #f3f4f6;
      border-top: 6px solid #dc2626;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 1.5rem;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .loading-text {
      color: #6b7280;
      font-size: 1.2rem;
      margin: 0;
    }

    .error-icon {
      font-size: 4rem;
      margin-bottom: 1rem;
    }

    .error-title {
      color: #dc2626;
      margin: 0 0 1rem 0;
      font-size: 1.5rem;
    }

    .error-message {
      color: #6b7280;
      margin: 0 0 2rem 0;
      font-size: 1.1rem;
    }

    .error-actions {
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    .error-actions .btn {
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      font-weight: 600;
      text-decoration: none;
      transition: all 0.2s;
      border: none;
      cursor: pointer;
    }

    .btn-primary {
      background: #dc2626;
      color: white;
    }

    .btn-primary:hover {
      background: #b91c1c;
    }

    .btn-secondary {
      background: #6b7280;
      color: white;
    }

    .btn-secondary:hover {
      background: #4b5563;
    }

    /* Responsive design */
    @media (max-width: 768px) {
      .runner-container {
        padding: 1rem;
      }
      
      .runner-header {
        padding: 1.5rem;
      }
      
      .runner-name {
        font-size: 2rem;
      }
      
      .runner-actions {
        flex-direction: column;
        align-items: center;
      }
      
      .action-btn {
        width: 100%;
        max-width: 300px;
        justify-content: center;
      }
      
      .info-grid {
        grid-template-columns: 1fr;
      }
      
      .error-actions {
        flex-direction: column;
        align-items: center;
      }
      
      .error-actions .btn {
        width: 100%;
        max-width: 300px;
      }
    }

    /* Hidden class */
    .hidden {
      display: none !important;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="header-bar">
      <img src="https://241runnersawareness.org/241-logo.jpg" alt="241 Runners Awareness Logo" class="logo" />
      <h1>241 Runners Awareness</h1>
    </div>
    
    <nav>
      <a href="https://241runnersawareness.org">Home</a>
      <a href="https://241runnersawareness.org/aboutus.html">About Us</a>
      <a href="https://241runnersawareness.org/cases.html">Cases</a>
      <a href="https://241runnersawareness.org/map.html">Map</a>
      <a href="https://241runnersawareness.org/dna-tracking.html">DNA Tracking</a>
      <a href="https://241runnersawareness.org/report-case.html">Report Case</a>
      <a href="https://241runnersawareness.org/profile.html" id="profileLink" style="display: none;">Profile</a>
      <a href="https://241runnersawareness.org/dashboard.html" id="dashboardLink" style="display: none;">Dashboard</a>
      <a href="https://241runnersawareness.org/admin/index.html" id="adminLink" style="display: none;">Admin</a>
      <button id="logoutBtn" class="logout-btn" style="display: none;">Logout</button>
      <a href="https://241runnersawareness.org/login.html" id="loginLink">Login</a>
      <a href="https://241runnersawareness.org/signup.html" id="signupLink">Sign Up</a>
    </nav>
    
    <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode" aria-pressed="false">
      ☀️
    </button>
    
    <button class="hamburger" aria-label="Toggle navigation menu" aria-expanded="false">
      <span></span>
      <span></span>
      <span></span>
    </button>
  </header>

  <!-- Main Content -->
  <main>
    <div class="runner-container">
      <!-- Loading State -->
      <div id="loadingState" class="loading-state">
        <div class="loading-spinner"></div>
        <p class="loading-text">Loading runner profile...</p>
      </div>

      <!-- Error State -->
      <div id="errorState" class="error-state hidden">
        <div class="error-icon">⚠️</div>
        <h2 class="error-title">Unable to load runner profile</h2>
        <p class="error-message" id="errorMessage">An error occurred while loading the runner profile.</p>
        <div class="error-actions">
          <button onclick="window.history.back()" class="btn btn-secondary">Go Back</button>
          <button onclick="location.reload()" class="btn btn-primary">Try Again</button>
        </div>
      </div>

      <!-- Runner Profile Content -->
      <div id="profileContent" class="profile-content hidden">
        <!-- Runner Header -->
        <div class="runner-header">
          <div class="runner-avatar" id="runnerAvatar">
            👤
          </div>
          <h1 class="runner-name" id="runnerName">Loading...</h1>
          <p class="runner-id" id="runnerId">Runner ID: Loading...</p>
          <span class="runner-status" id="runnerStatus">Loading...</span>
          
          <!-- Action Buttons -->
          <div class="runner-actions">
            <a href="https://241runnersawareness.org/cases.html" class="action-btn action-btn-secondary">
              ← Back to Cases
            </a>
            <a href="https://241runnersawareness.org/report-case.html" class="action-btn action-btn-primary">
              + Report Case
            </a>
            <a id="editRunnerLink" href="#" class="action-btn action-btn-primary" style="display: none;">
              ✏️ Edit Profile
            </a>
          </div>
        </div>

        <!-- Profile Sections -->
        <div class="profile-sections">
          <!-- Basic Information -->
          <div class="profile-section">
            <div class="section-header">
              <h2 class="section-title">Basic Information</h2>
              <span class="section-badge">Public</span>
            </div>
            <div class="info-grid">
              <div class="info-item">
                <label class="info-label">Full Name</label>
                <span id="fullName" class="info-value">Loading...</span>
              </div>
              <div class="info-item">
                <label class="info-label">Age</label>
                <span id="age" class="info-value">Loading...</span>
              </div>
              <div class="info-item">
                <label class="info-label">Gender</label>
                <span id="gender" class="info-value">Loading...</span>
              </div>
              <div class="info-item">
                <label class="info-label">Status</label>
                <span id="status" class="info-value">Loading...</span>
              </div>
              <div class="info-item">
                <label class="info-label">Date Reported</label>
                <span id="dateReported" class="info-value">Loading...</span>
              </div>
              <div class="info-item">
                <label class="info-label">Last Seen</label>
                <span id="lastSeen" class="info-value">Loading...</span>
              </div>
            </div>
          </div>

          <!-- Physical Description -->
          <div class="profile-section">
            <div class="section-header">
              <h2 class="section-title">Physical Description</h2>
              <span class="section-badge">Public</span>
            </div>
            <div class="info-grid">
              <div class="info-item">
                <label class="info-label">Height</label>
                <span id="height" class="info-value">Loading...</span>
              </div>
              <div class="info-item">
                <label class="info-label">Weight</label>
                <span id="weight" class="info-value">Loading...</span>
              </div>
              <div class="info-item">
                <label class="info-label">Hair Color</label>
                <span id="hairColor" class="info-value">Loading...</span>
              </div>
              <div class="info-item">
                <label class="info-label">Eye Color</label>
                <span id="eyeColor" class="info-value">Loading...</span>
              </div>
              <div class="info-item">
                <label class="info-label">Identifying Marks</label>
                <span id="identifyingMarks" class="info-value">Loading...</span>
              </div>
              <div class="info-item">
                <label class="info-label">Description</label>
                <span id="description" class="info-value">Loading...</span>
              </div>
            </div>
          </div>

          <!-- Location Information -->
          <div class="profile-section">
            <div class="section-header">
              <h2 class="section-title">Location Information</h2>
              <span class="section-badge">Public</span>
            </div>
            <div class="info-grid">
              <div class="info-item">
                <label class="info-label">Last Seen Location</label>
                <span id="lastSeenLocation" class="info-value">Loading...</span>
              </div>
              <div class="info-item">
                <label class="info-label">City</label>
                <span id="city" class="info-value">Loading...</span>
              </div>
              <div class="info-item">
                <label class="info-label">State</label>
                <span id="state" class="info-value">Loading...</span>
              </div>
            </div>
          </div>

          <!-- Contact Information (Authenticated Users Only) -->
          <div id="contactInfoCard" class="profile-section" style="display: none;">
            <div class="section-header">
              <h2 class="section-title">Contact Information</h2>
              <span class="section-badge">Private</span>
            </div>
            <div class="info-grid">
              <div class="info-item">
                <label class="info-label">Email</label>
                <span id="email" class="info-value">Loading...</span>
              </div>
              <div class="info-item">
                <label class="info-label">Phone</label>
                <span id="phoneNumber" class="info-value">Loading...</span>
              </div>
              <div class="info-item">
                <label class="info-label">Address</label>
                <span id="address" class="info-value">Loading...</span>
              </div>
            </div>
          </div>

          <!-- Medical Information (Authenticated Users Only) -->
          <div id="medicalInfoCard" class="profile-section" style="display: none;">
            <div class="section-header">
              <h2 class="section-title">Medical Information</h2>
              <span class="section-badge">Private</span>
            </div>
            <div class="info-grid">
              <div class="info-item">
                <label class="info-label">Medical Conditions</label>
                <span id="medicalConditions" class="info-value">Loading...</span>
              </div>
              <div class="info-item">
                <label class="info-label">Medications</label>
                <span id="medications" class="info-value">Loading...</span>
              </div>
              <div class="info-item">
                <label class="info-label">Allergies</label>
                <span id="allergies" class="info-value">Loading...</span>
              </div>
              <div class="info-item">
                <label class="info-label">Emergency Contacts</label>
                <span id="emergencyContacts" class="info-value">Loading...</span>
              </div>
            </div>
          </div>

          <!-- Cases Section (Authenticated Users Only) -->
          <div id="casesSection" class="profile-section" style="display: none;">
            <div class="section-header">
              <h2 class="section-title">Related Cases</h2>
              <span class="section-badge">Private</span>
            </div>
            <div id="casesContainer">
              <p style="text-align: center; color: #6b7280;">No related cases found.</p>
            </div>
          </div>

          <!-- Public Notice for Restricted Content -->
          <div id="publicNotice" class="restricted-message" style="display: none;">
            <h3>🔒 Additional Information Available</h3>
            <p>Sign in to view contact details, medical information, and related cases for this runner profile.</p>
            <a href="https://241runnersawareness.org/login.html" class="btn">Sign In to View More</a>
          </div>
        </div>
      </div>
    </div>
  </main>

  <footer role="contentinfo">
    <p>&copy; 2025 241 Runners Awareness. All rights reserved.</p>
  </footer>

  <script>
    // API Configuration
            const API_BASE_URL = 'https://241runnersawareness-api.azurewebsites.net/api';
    
    // Get runner ID from URL
    const urlParams = new URLSearchParams(window.location.search);
    const runnerId = urlParams.get('id') || '1';
    
    // Check authentication on page load
    document.addEventListener('DOMContentLoaded', function() {
      console.log('🚀 Runner profile page loaded');
      console.log('🔍 Runner ID:', runnerId);
      
      checkAuth();
      loadRunnerData();
      setupEventListeners();
    });

    // Check authentication
    function checkAuth() {
      const user = localStorage.getItem('user');
      if (user) {
        // User is authenticated
        document.getElementById('profileLink').style.display = 'inline';
        document.getElementById('dashboardLink').style.display = 'inline';
        document.getElementById('logoutBtn').style.display = 'inline';
        document.getElementById('loginLink').style.display = 'none';
        document.getElementById('signupLink').style.display = 'none';
        
        // Show restricted content
        document.getElementById('contactInfoCard').style.display = 'block';
        document.getElementById('medicalInfoCard').style.display = 'block';
        document.getElementById('casesSection').style.display = 'block';
        document.getElementById('publicNotice').style.display = 'none';
        
        // Show edit link for authenticated users
        const editLink = document.getElementById('editRunnerLink');
        if (editLink) {
          editLink.style.display = 'inline-flex';
          editLink.href = `https://241runnersawareness.org/report-case.html?id=${runnerId}`;
        }
      } else {
        // User is not authenticated (public view)
        document.getElementById('profileLink').style.display = 'none';
        document.getElementById('dashboardLink').style.display = 'none';
        document.getElementById('logoutBtn').style.display = 'none';
        document.getElementById('loginLink').style.display = 'inline';
        document.getElementById('signupLink').style.display = 'inline';
        
        // Hide restricted content
        document.getElementById('contactInfoCard').style.display = 'none';
        document.getElementById('medicalInfoCard').style.display = 'none';
        document.getElementById('casesSection').style.display = 'none';
        document.getElementById('publicNotice').style.display = 'block';
        
        // Hide edit link for public users
        document.getElementById('editRunnerLink').style.display = 'none';
      }
    }

    // Set up event listeners
    function setupEventListeners() {
      // Logout button
      const logoutBtn = document.getElementById('logoutBtn');
      if (logoutBtn) {
        logoutBtn.addEventListener('click', logout);
      }

      // Theme toggle
      const themeToggle = document.getElementById('theme-toggle');
      if (themeToggle) {
        themeToggle.addEventListener('click', toggleTheme);
      }

      // Hamburger menu
      const hamburger = document.querySelector('.hamburger');
      const nav = document.querySelector('nav');
      if (hamburger && nav) {
        hamburger.addEventListener('click', function() {
          hamburger.classList.toggle('active');
          nav.classList.toggle('active');
        });
      }
    }

    // Load runner data
    async function loadRunnerData() {
      try {
        console.log('📋 Loading runner data for ID:', runnerId);
        
        // Show loading state
        const loadingState = document.getElementById('loadingState');
        const errorState = document.getElementById('errorState');
        const profileContent = document.getElementById('profileContent');
        
        if (loadingState) loadingState.classList.remove('hidden');
        if (errorState) errorState.classList.add('hidden');
        if (profileContent) profileContent.classList.add('hidden');

        // Try to load from API first
        const apiUrl = `${API_BASE_URL}/runners/${runnerId}`;
        console.log('🌐 Fetching from API:', apiUrl);
        
        const response = await fetch(apiUrl);
        console.log('📡 API Response status:', response.status);
        
        if (response.ok) {
          const runnerData = await response.json();
          console.log('✅ Loaded runner data from API:', runnerData);
          
          if (runnerData && runnerData.id) {
            updateRunnerDisplay(runnerData);
          } else {
            throw new Error('Invalid runner data received from API');
          }
        } else if (response.status === 404) {
          showError(`Runner with ID ${runnerId} not found.`);
          return;
        } else {
          throw new Error(`HTTP ${response.status}: ${response.statusText}`);
        }

      } catch (error) {
        console.error('❌ Error loading runner data:', error);
        
        // Show error message to user
        const errorMessage = document.createElement('div');
        errorMessage.className = 'error-message text-center py-8';
        errorMessage.innerHTML = `
          <div class="text-red-600 text-xl font-semibold mb-4">Failed to load runner data</div>
          <div class="text-gray-600 mb-4">Unable to retrieve runner information. Please try again later.</div>
          <button onclick="location.reload()" class="bg-red-600 text-white px-6 py-2 rounded-lg hover:bg-red-700 transition-colors">
            Retry
          </button>
        `;
        
        const profileContent = document.getElementById('profileContent');
        if (profileContent) {
          profileContent.innerHTML = '';
          profileContent.appendChild(errorMessage);
        }
        
      } finally {
        // Hide loading, show content
        const loadingState = document.getElementById('loadingState');
        const profileContent = document.getElementById('profileContent');
        
        if (loadingState) loadingState.classList.add('hidden');
        if (profileContent) profileContent.classList.remove('hidden');
        
        console.log('🎉 Runner profile loaded successfully!');
      }
    }



    // Update runner display
    function updateRunnerDisplay(runner) {
      console.log('🎨 Updating display with runner data:', runner);
      
      // Update header
      const fullName = runner.fullName || `${runner.firstName || ''} ${runner.lastName || ''}`.trim();
      const initials = fullName.split(' ').map(n => n[0]).join('').toUpperCase();
      
      document.getElementById('runnerAvatar').textContent = initials || '👤';
      document.getElementById('runnerName').textContent = fullName || 'Unknown Runner';
      document.getElementById('runnerId').textContent = `Runner ID: ${runner.runnerId || 'N/A'}`;
      
      const statusElement = document.getElementById('runnerStatus');
      const status = runner.status || 'Unknown';
      statusElement.textContent = status;
      statusElement.className = `runner-status ${getStatusClass(status)}`;

      // Update basic information
      document.getElementById('fullName').textContent = fullName || 'Not provided';
      document.getElementById('age').textContent = runner.age || 'Not provided';
      document.getElementById('gender').textContent = runner.gender || 'Not provided';
      document.getElementById('status').textContent = status;
      document.getElementById('dateReported').textContent = runner.dateReported ? new Date(runner.dateReported).toLocaleDateString() : 'Not provided';
      document.getElementById('lastSeen').textContent = runner.lastSeen ? new Date(runner.lastSeen).toLocaleDateString() : 'Not provided';

      // Update location information
      document.getElementById('lastSeenLocation').textContent = runner.lastSeenLocation || 'Not provided';
      document.getElementById('city').textContent = runner.city || 'Not provided';
      document.getElementById('state').textContent = runner.state || 'Not provided';

      // Update physical description
      document.getElementById('height').textContent = runner.height || 'Not provided';
      document.getElementById('weight').textContent = runner.weight || 'Not provided';
      document.getElementById('hairColor').textContent = runner.hairColor || 'Not provided';
      document.getElementById('eyeColor').textContent = runner.eyeColor || 'Not provided';
      document.getElementById('identifyingMarks').textContent = runner.identifyingMarks || 'Not provided';
      document.getElementById('description').textContent = runner.description || 'No description available';

      // Update contact information (only if authenticated)
      const emailElement = document.getElementById('email');
      if (emailElement) {
        emailElement.textContent = runner.email || 'Not provided';
      }
      
      const phoneElement = document.getElementById('phoneNumber');
      if (phoneElement) {
        phoneElement.textContent = runner.contactInfo || 'Not provided';
      }
      
      const addressElement = document.getElementById('address');
      if (addressElement) {
        addressElement.textContent = runner.address || 'Not provided';
      }

      // Update medical information (only if authenticated)
      const medicalElement = document.getElementById('medicalConditions');
      if (medicalElement) {
        medicalElement.textContent = runner.medicalConditions || 'Not provided';
      }
      
      const medsElement = document.getElementById('medications');
      if (medsElement) {
        medsElement.textContent = runner.medications || 'Not provided';
      }
      
      const allergiesElement = document.getElementById('allergies');
      if (allergiesElement) {
        allergiesElement.textContent = runner.allergies || 'Not provided';
      }
      
      const emergencyElement = document.getElementById('emergencyContacts');
      if (emergencyElement) {
        emergencyElement.textContent = runner.emergencyContacts || 'Not provided';
      }
    }

    // Get status class for styling
    function getStatusClass(status) {
      switch (status?.toLowerCase()) {
        case 'active': return 'active';
        case 'missing': return 'missing';
        case 'found': return 'found';
        case 'safe': return 'active';
        case 'urgent': return 'missing';
        case 'inactive': return 'inactive';
        default: return 'missing';
      }
    }

    // Show error message
    function showError(message) {
      const loadingState = document.getElementById('loadingState');
      const errorState = document.getElementById('errorState');
      const profileContent = document.getElementById('profileContent');
      
      if (loadingState) loadingState.classList.add('hidden');
      if (errorState) errorState.classList.remove('hidden');
      if (profileContent) profileContent.classList.add('hidden');
      
      document.getElementById('errorMessage').textContent = message;
    }

    // Logout function
    function logout() {
      localStorage.removeItem('user');
      window.location.reload();
    }

    // Theme toggle
    function toggleTheme() {
      const body = document.body;
      const themeToggle = document.getElementById('theme-toggle');
      
      body.classList.toggle('dark-mode');
      
      if (body.classList.contains('dark-mode')) {
        localStorage.setItem('theme', 'dark');
        themeToggle.textContent = '🌙';
        themeToggle.setAttribute('aria-pressed', 'true');
      } else {
        localStorage.setItem('theme', 'light');
        themeToggle.textContent = '☀️';
        themeToggle.setAttribute('aria-pressed', 'false');
      }
    }

    // Check for saved theme preference
    const currentTheme = localStorage.getItem('theme') || 'light';
    if (currentTheme === 'dark') {
      document.body.classList.add('dark-mode');
      const themeToggle = document.getElementById('theme-toggle');
      if (themeToggle) {
        themeToggle.textContent = '🌙';
        themeToggle.setAttribute('aria-pressed', 'true');
      }
    }
  </script>
</body>
</html>
